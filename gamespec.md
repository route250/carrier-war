# ゲーム仕様（最小スコープ）

## タイトル（候補）
- キャリア・ハント
- アイランズ・アット・ドーン
（決定は実装直前でOK）

## 種別
- ターン制・海戦ミニ戦術SLG（1対1）

## 目標
- 敵空母を撃沈する。
- もしくは制限ターン終了時に敵より優勢（敵HPより自HPが高い）。

## マップ / 地形
- サイズ: 30×30 のヘックス（pointy-top, odd-r、長方形）
- 地形: 海/島（開始時にランダム生成）。自艦/敵艦の初期周囲は海へ浸食し、外洋へ水路を保証

## ユニット
- 自軍: 空母1、航空機編隊 最大2（出撃中を含む）
- 敵軍: 空母1、航空機編隊 最大2

- いずれも距離・視界は「ヘックス距離」で測る
## 基本数値（実装）
- 空母: HP 100 / 速度 2hex / 視界 10hex
- 航空機編隊: HP 40（ゲーム中は回復しない）/ 速度 10hex / 視界 10hex
- 攻撃: 基礎25 ±20% を「現在HP/最大HP」でスケール（損耗で火力低下）
- 対空砲火（AA）: 基礎20 ±20% を「空母HP/最大HP」でスケール（損傷で弱体）
- 発見持続: 発見した敵は3ターン表示（最後に見た位置を保持）

## ターン構成（実装）
1. プレイヤー入力（空母移動/出撃）
2. 自軍編隊の行動（接近→条件達成で攻撃→帰還判定）
3. 敵AI（空母移動/出撃/編隊行動）
4. 可視情報の更新（記憶TTL減衰）と描画

- 空母移動: 2hex以内で目的地指定。島/占有ヘックスは不可。
- 出撃: 空母は搭載枠（最大2）ぶんの「編隊プール」を持つ。出撃可能なのは状態baseかつHP>0の編隊。
  - 発艦位置は空母の周囲6ヘックスの「海かつ未占有」から選択。
  - 目標地点を指定すると、自律的に最大10hex/ターンで目標へ向かう。
  - 航空機は島を無視して移動できる（地形の影響を受けない）。占有ヘックスのみ回避。
- 接敵と攻撃: 敵空母を視界10で発見したら接近。1マス以内に到達できたターンはそのまま攻撃。
  - 与ダメ: 基礎25±20% × 編隊HP割合。空母HPが0で撃沈。
  - 直後に空母の対空砲火（基礎20±20% × 空母HP割合）を受ける。編隊HP<=0で撃墜（lost）。
  - 生存時は帰還に移行。
- 帰還: 空母の1マス以内で帰還完了（状態base）。HPは回復しない。
- 空振り: 目標到達かつ敵未発見時は即時に帰還行動へ。
- 報告: 索敵結果をログに出力。記憶対象は半透明＋点線枠で表示。

## マス占有と距離ルール
- 1ヘックスに存在できるユニットは1つ（空母/自軍編隊/敵編隊）。
- 航空機は島上空を通過・滞在してよい（地形無視）。
- 編隊は空母の同一ヘックスに入らない。攻撃・帰還は「距離=1」で扱う。

## 索敵 / 可視化
- 空母・編隊とも視界は半径10マス。
- 発見した敵ユニットは3ターン表示（最後に見た位置を保持）。記憶表示は半透明＋点線枠。

## 勝敗 / 制限
- 勝利: 敵空母撃沈、または20ターン終了時に自空母HPが上回る。
- 敗北: 自空母撃沈。

## 画面/UI
- 左: マップ（自軍=青四角/自軍編隊=黄円/敵空母=赤四角/敵編隊=橙ひし形）。記憶は半透明＋点線。
- 右: ステータスパネル
  - 空母のHP/位置/搭載枠（出撃中枠）
  - 編隊の状態（基地/出撃/接敵/帰還/損失）、位置/目標/HP
- 下部: ログ（発見/攻撃/AA/撃墜/帰還/ターン）
- ヘッダ: モード切替（選択/移動/出撃）、次ターン、リスタート/新しい海域

- 空母: ランダムに2hex以内で移動（島・占有ヘックスを避ける）。
- 出撃: 
  - 情報あり: プレイヤー空母の最後の目撃位置へ打撃出撃（baseの編隊から）。
  - 情報なし: 3ターン毎に四隅＋中心を巡回する索敵出撃（パトロール）。
  - 発艦は空母周囲の空きマス。編隊も接近→攻撃→AA→帰還/撃墜の流れ。

## 実装メモ（データ構造の目安）
- マップ: `tiles[y][x]`（0=海/1=島）。自艦/敵艦の初期周囲は海に掘削し、外洋に抜ける水路を保証。
- 空母: `{id, x, y, hp, speed=2, vision=10, hangar=2}`
- 編隊（プール）: `{id, hp, state: 'base'|'outbound'|'engaging'|'returning'|'lost', x?, y?, target?, speed=10, vision=10}`
- 可視情報: 敵空母/編隊の記憶位置と `ttl=3`

## スコープ外（将来拡張）
- 戦闘機/攻撃機の区別や迎撃戦
- 燃料/弾数/整備待ち
- 対空砲火、天候、夜間
- 複数艦、補給、指揮範囲

以上の仕様で、最小限の遊べる形を短期実装 → その後、段階的に拡張します。
